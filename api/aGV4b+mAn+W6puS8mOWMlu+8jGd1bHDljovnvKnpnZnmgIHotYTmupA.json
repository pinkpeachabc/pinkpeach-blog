{"title":"hexo速度优化，gulp压缩静态资源","date":"2019-12-31T14:21:12.000Z","date_formatted":{"ll":"2019年12月31日","L":"2019/12/31","MM-DD":"12-31"},"link":"hexo速度优化，gulp压缩静态资源","comments":true,"tags":["hexo"],"categories":["博客"],"updated":"2020-01-31T12:04:02.000Z","content":"<blockquote>\n<p>hexo生成的的public文件夹里的源文件有很多空白，这些空白占据一定空间。<a href=\"https://www.gulpjs.com.cn/\" target=\"_blank\">gulp</a>可以高效的压缩这些静态资源，从而提高访问速度。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h4 id=\"插件安装\">插件安装<a title=\"#插件安装\" href=\"#插件安装\"></a></h4>\n<p>安装<code>gulp</code>工具</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install gulp</span><br></pre></td></tr></table></figure>\n<p>安装gulp模块：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gulp-htmlclean // 清理html</span><br><span class=\"line\">gulp-htmlmin // 压缩html</span><br><span class=\"line\">gulp-minify-css // 压缩css</span><br><span class=\"line\">gulp-uglify // 混淆js</span><br></pre></td></tr></table></figure>\n<p>安装命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify --save</span><br></pre></td></tr></table></figure>\n<h4 id=\"创建任务\">创建任务<a title=\"#创建任务\" href=\"#创建任务\"></a></h4>\n<p>在站点根目录下新建<code>gulpfile.js</code>文件，内容如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> gulp = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Plugins模块获取</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> minifycss = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-minify-css&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> uglify = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-uglify&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> htmlmin = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-htmlmin&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> htmlclean = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-htmlclean&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//压缩css</span></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;minify-css&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"><span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;./public/**/*.css&#x27;</span>)</span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(<span class=\"title function_\">minifycss</span>())</span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;./public&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//压缩html</span></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;minify-html&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"><span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;./public/**/*.html&#x27;</span>)</span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(<span class=\"title function_\">htmlclean</span>())</span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(<span class=\"title function_\">htmlmin</span>(&#123;</span><br><span class=\"line\"><span class=\"attr\">removeComments</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">minifyJS</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">minifyCSS</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\"><span class=\"attr\">minifyURLs</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">&#125;))</span><br><span class=\"line\"></span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;./public&#x27;</span>))</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//压缩js 不压缩min.js</span></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;minify-js&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"><span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>([<span class=\"string\">&#x27;./public/**/*.js&#x27;</span>, <span class=\"string\">&#x27;!./public/**/*.min.js&#x27;</span>])</span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(<span class=\"title function_\">uglify</span>())</span><br><span class=\"line\">.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;./public&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//4.0以前的写法 </span></span><br><span class=\"line\"><span class=\"comment\">//gulp.task(&#x27;default&#x27;, [</span></span><br><span class=\"line\">  <span class=\"comment\">//  &#x27;minify-html&#x27;, &#x27;minify-css&#x27;, &#x27;minify-js&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">//]);</span></span><br><span class=\"line\"><span class=\"comment\">//4.0以后的写法</span></span><br><span class=\"line\"><span class=\"comment\">// 执行 gulp 命令时执行的任务</span></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;default&#x27;</span>, gulp.<span class=\"title function_\">parallel</span>(<span class=\"string\">&#x27;minify-html&#x27;</span>, <span class=\"string\">&#x27;minify-css&#x27;</span>, <span class=\"string\">&#x27;minify-js&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// Do something after a, b, and c are finished.</span></span><br><span class=\"line\">&#125;));</span><br></pre></td></tr></table></figure>\n<h4 id=\"使用\">使用<a title=\"#使用\" href=\"#使用\"></a></h4>\n<p>命令：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean //先清理文件</span><br><span class=\"line\">hexo g  //编译生成静态文件</span><br><span class=\"line\">gulp  //gulp插件执行压缩任务</span><br><span class=\"line\">hexo s //开启服务</span><br></pre></td></tr></table></figure>\n<p>当然，通过一个命令也可以：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo g &amp;&amp; gulp -d</span><br></pre></td></tr></table></figure>","prev":{"title":"Android数据储存","link":"Android数据储存"},"next":{"title":"macOS 外接鼠标也丝滑柔顺","link":"macOS-如何像-Windows-一样使用鼠标"},"plink":"https://pinkpeachabc.cn/hexo速度优化，gulp压缩静态资源/","reward":true,"copyright":{"author":"PinkPeach","link":"<a href=\"https://pinkpeachabc.cn/hexo速度优化，gulp压缩静态资源/\" title=\"hexo速度优化，gulp压缩静态资源\">https://pinkpeachabc.cn/hexo速度优化，gulp压缩静态资源/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}